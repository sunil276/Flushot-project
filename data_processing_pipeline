# import libraries
import pandas as pd
from sklearn.preprocessing import LabelEncoder
import os

# Import Modules
import helper

try:
    # Part - 1
    data = pd.read_csv(r"C:\Users\Manu\Downloads\training_set_features.csv")
    trainings_labels=pd.read_csv(r"D:\Sunil\DrivenData\FluShotLearning\training_set_labels.csv")
    numerical_cols = data.select_dtypes(include=['float64']).columns
    categorical_cols = data.select_dtypes(include=['object']).columns
    data = helper.replace_nan(data, numerical_cols, 9999)
    data = helper.replace_nan(data, categorical_cols, 'XYZ')
    columns_list = ['age_group',
                    'education', 'race', 'sex', 'income_poverty', 'marital_status',
                    'rent_or_own', 'employment_status', 'hhs_geo_region', 'census_msa', 'employment_industry',
                    'employment_occupation']
    data=helper.label_encode(df=data, cols=columns_list)

    # Part - 2
    final_data=pd.merge(data,trainings_labels,on="respondent_id",how="left")


except Exception as e:
    print(e)
